import { useEffect, useState } from 'react';
import { supabase } from '../../lib/supabaseClient';

export default function AdminProjects(){ const [projects,setProjects]=useState<any[]>([]); const [title,setTitle]=useState(''); useEffect(()=>{ load(); },[]); async function load(){ const { data } = await supabase.from('projects').select('*').order('created_at',{ascending:false}); setProjects(data || []); } async function createProject(){ await supabase.from('projects').insert([{ title, short_description: 'وصف تجريبي', tech: ['Next.js','Supabase'] }]); setTitle(''); load(); } async function remove(id:any){ await supabase.from('projects').delete().eq('id', id); load(); } return (<div><h1 className="text-2xl font-bold">إدارة المشاريع</h1><div className="mt-4"><input value={title} onChange={e=>setTitle(e.target.value)} placeholder="اسم المشروع" className="p-2 border rounded" /><button onClick={createProject} className="ml-2 px-3 py-2 bg-primary text-white rounded">إضافة</button></div><ul className="mt-6 space-y-3">{projects.map(p=> (<li key={p.id} className="p-3 border rounded flex justify-between"><div><div className="font-semibold">{p.title}</div><div className="text-sm text-gray-500">{p.short_description}</div></div><div className="flex gap-2"><button onClick={()=>remove(p.id)} className="px-3 py-1 border rounded">حذف</button></div></li>))}</ul></div>);
}
